apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
  name: buildah-as-user
  namespace: {{ .Release.Namespace }}
spec:
  params:
  workspaces:
    - name: code
      description: the sourcecode from prev. steps
      mountPath: /app
  steps:
    - image: ghcr.io/tomeindl/buildahimage:latest
      name: build
      resources: { }
      script: |-
        #!/usr/bin/env sh
        id
        ls -a
        pwd
        cat app/Containerfile
        echo 'FROM ubuntu' > Containerfile
        buildah bud -t blub -f Containerfile .
