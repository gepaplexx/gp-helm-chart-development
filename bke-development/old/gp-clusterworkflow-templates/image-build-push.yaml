apiVersion: argoproj.io/v1alpha1
kind: ClusterWorkflowTemplate
metadata:
  annotations:
    kubectl.kubernetes.io/last-applied-configuration: |
      {"apiVersion":"argoproj.io/v1alpha1","kind":"ClusterWorkflowTemplate","metadata":{"annotations":{},"name":"image-build-push"},"spec":{"templates":[{"container":{"args":["--dockerfile=Containerfile","--context=/mnt/out/{{ workflow.parameters.reponame }}","--destination=image-registry.openshift-image-registry.svc.cluster.local:5000/{{ workflow.namespace }}/{{=sprig.lower(workflow.parameters.reponame) }}:{{ workflow.parameters.tag }}","--skip-tls-verify","--verbosity=debug"],"image":"gcr.io/kaniko-project/executor:v1.7.0","volumeMounts":[{"mountPath":"/mnt/out/","name":"workspace"},{"mountPath":"/kaniko/.docker","name":"dockerconfig"}]},"metadata":{"labels":{"app":"argo"}},"name":"image-build-push","volumes":[{"name":"dockerconfig","secret":{"items":[{"key":".dockerconfigjson","path":"config.json"}],"secretName":"builder-dockerconfig"}}]}]}}
  creationTimestamp: "2022-02-10T14:37:09Z"
  generation: 9
  name: image-build-push
  resourceVersion: "593064138"
  uid: 4d6b95eb-3dae-4eef-a487-07c7265e11d4
spec:
  templates:
  - container:
      args:
      - --dockerfile=Containerfile
      - --context=/mnt/out/{{ workflow.parameters.reponame }}
      - --destination=image-registry.openshift-image-registry.svc.cluster.local:5000/{{
        workflow.namespace }}/{{=sprig.lower(workflow.parameters.reponame) }}:{{ workflow.parameters.tag
        }}
      - --skip-tls-verify
      - --verbosity=debug
      image: gcr.io/kaniko-project/executor:v1.7.0
      volumeMounts:
      - mountPath: /mnt/out/
        name: workspace
      - mountPath: /kaniko/.docker
        name: dockerconfig
    metadata:
      labels:
        app: argo
    name: image-build-push
    volumes:
    - name: dockerconfig
      secret:
        items:
        - key: .dockerconfigjson
          path: config.json
        secretName: builder-dockerconfig
